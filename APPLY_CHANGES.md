# Инструкция по применению изменений

## Быстрый старт

### 1. Применение миграции базы данных

Откройте терминал в корне проекта и выполните:

```bash
cd backend
npx prisma migrate dev --name add_product_components
```

**Важно**: Эта команда интерактивная, поэтому её нужно запускать вручную в терминале (не через скрипты).

Если команда запросит подтверждение, нажмите `Enter` для применения миграции.

### 2. Генерация Prisma Client

После успешной миграции выполните:

```bash
npx prisma generate
```

### 3. Перезапуск серверов

**Backend:**
```bash
cd backend
npm run start:dev
```

**Frontend** (если нужно):
```bash
cd frontend
npm run dev
```

## Что было добавлено

### База данных:
- ✅ Новая таблица `product_components` для хранения комплектующих
- ✅ Поле `componentId` в таблице `cart_items` для поддержки комплектующих в корзине

### Backend API:
- ✅ CRUD операции для комплектующих (`/api/v1/product-components`)
- ✅ Добавление комплектующих в корзину (`/api/v1/cart/component/:componentId`)

### Frontend:
- ✅ Отображение комплектующих на странице товара (только для "Двери межкомнатные")
- ✅ Управление комплектующими в админ-панели

## Проверка работы

1. **В админ-панели:**
   - Откройте редактирование любого товара из категории "Двери межкомнатные"
   - Внизу формы должен появиться раздел "Комплектующие"
   - Добавьте тестовое комплектующее

2. **На сайте:**
   - Откройте страницу товара из категории "Двери межкомнатные"
   - Внизу страницы должен появиться раздел "Комплектующие"
   - Проверьте добавление в корзину

## Если возникли проблемы

### Ошибка при миграции:
```bash
# Проверьте подключение к БД
cd backend
cat .env | grep DATABASE_URL

# Попробуйте альтернативный способ
npx prisma db push
npx prisma generate
```

### Ошибка "Prisma Client не найден":
```bash
cd backend
npx prisma generate
```

### Ошибки TypeScript:
- Перезапустите TypeScript сервер в VS Code (Ctrl+Shift+P → "TypeScript: Restart TS Server")
- Или перезапустите IDE

## Дополнительная информация

Подробная документация находится в `backend/MIGRATION_INSTRUCTIONS.md`
